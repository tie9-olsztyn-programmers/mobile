"use strict";(self.webpackChunkmobile=self.webpackChunkmobile||[]).push([[2930],{3593:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Mobilne w XML i Kotlinie/Nawigacja i  fragmenty/Fragmenty/czesc2PrzekazywanieDanych","title":"cz. 2 Przekazywanie argument\xf3w w Navigation Component","description":"Przypomnienie","source":"@site/docs/10. Mobilne w XML i Kotlinie/10.Nawigacja i  fragmenty/10.Fragmenty/14.czesc2PrzekazywanieDanych.mdx","sourceDirName":"10. Mobilne w XML i Kotlinie/10.Nawigacja i  fragmenty/10.Fragmenty","slug":"/Mobilne w XML i Kotlinie/Nawigacja i  fragmenty/Fragmenty/czesc2PrzekazywanieDanych","permalink":"/mobile/docs/Mobilne w XML i Kotlinie/Nawigacja i  fragmenty/Fragmenty/czesc2PrzekazywanieDanych","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/10. Mobilne w XML i Kotlinie/10.Nawigacja i  fragmenty/10.Fragmenty/14.czesc2PrzekazywanieDanych.mdx","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"title":"cz. 2 Przekazywanie argument\xf3w w Navigation Component"},"sidebar":"tutorialSidebar","previous":{"title":"cz. 1 Przekazywanie argument\xf3w w Navigation Component","permalink":"/mobile/docs/Mobilne w XML i Kotlinie/Nawigacja i  fragmenty/Fragmenty/PrzekazywanieDanych"},"next":{"title":"ViewModel - przekazywanie danych","permalink":"/mobile/docs/Mobilne w XML i Kotlinie/Nawigacja i  fragmenty/Fragmenty/PrzekazywanieDanychViewModel"}}');var o=i(4848),t=i(8453);const r={title:"cz. 2 Przekazywanie argument\xf3w w Navigation Component"},d="Komunikacja dwukierunkowa - M\xf3j w\u0142asny potw\xf3r",c={},l=[{value:"Przypomnienie",id:"przypomnienie",level:2},{value:"Za\u0142o\u017cenia",id:"za\u0142o\u017cenia",level:2},{value:"Zmiany w kodach XML",id:"zmiany-w-kodach-xml",level:2},{value:"Zmiany w kodach Kotlina",id:"zmiany-w-kodach-kotlina",level:2},{value:"<code>FirstFragment.kt</code>",id:"firstfragmentkt",level:3},{value:"<code>SecondFragment.kt</code>",id:"secondfragmentkt",level:3}];function s(n){const e={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"komunikacja-dwukierunkowa---m\xf3j-w\u0142asny-potw\xf3r",children:"Komunikacja dwukierunkowa - M\xf3j w\u0142asny potw\xf3r"})}),"\n",(0,o.jsx)(e.h2,{id:"przypomnienie",children:"Przypomnienie"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["kontynuujemy projekt z poprzedniej lekcji","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"pierwszy fragment pobiera\u0142 imi\u0119"}),"\n",(0,o.jsx)(e.li,{children:"wysy\u0142e\u0142 dane do drugiego fragmentu"}),"\n",(0,o.jsx)(e.li,{children:"drugi fragment dane te wy\u015bwietla\u0142"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"za\u0142o\u017cenia",children:"Za\u0142o\u017cenia"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"W pierwszym fragmencie wpisujemy imi\u0119 potwora"}),"\n",(0,o.jsx)(e.li,{children:"W drugim wybieramy jego charakter, kolor sk\xf3ry i ilo\u015b\u0107 oczu"}),"\n",(0,o.jsx)(e.li,{children:"Dane wracaj\u0105 do pierwszego fragmentu i wy\u015bwietlamy opis gotowego potwora"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"zmiany-w-kodach-xml",children:"Zmiany w kodach XML"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["zmieniamy nazw\u0119 argumentu w ",(0,o.jsx)(e.code,{children:"nav_graph.xml"})," na ",(0,o.jsx)(e.code,{children:"monsterName"})]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'    <fragment\n        android:id="@+id/secondFragment"\n        android:name="com.example.navcompsafeargs.SecondFragment"\n        android:label="fragment_second"\n        tools:layout="@layout/fragment_second" >\n\n        <argument\n            android:name="mosterName"\n            app:argType="string"\n            android:defaultValue="Godzilla" />\n    </fragment>\n'})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["dodajemy w ",(0,o.jsx)(e.code,{children:"fragment_first.xml"})," wid\u017cet do wy\u015bwietlania wszystkich danych o potworze (po ",(0,o.jsx)(e.code,{children:"Button"}),")"]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- ... --\x3e\n\n  <TextView\n        android:id="@+id/resultText"\n        android:text=""\n        android:textSize="18sp"\n        android:layout_marginTop="24dp"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        tools:text="Tu b\u0119dzie imi\u0119 potwora"\n        />\n\n\x3c!-- ... --\x3e\n\n'})}),"\n",(0,o.jsx)(e.admonition,{type:"tip",children:(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"android:text"})," ustawia tekst w czasie dzia\u0142ania aplikacji (",(0,o.jsx)(e.em,{children:"runtime"}),")."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"tools:text"}),"  ustawia tekst tylko w edytorze layoutu (",(0,o.jsx)(e.em,{children:"preview"}),") - trzeba doimportowa\u0107"]}),"\n"]})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["dodajemy odpowiednie wid\u017cety w ",(0,o.jsx)(e.code,{children:"fragment_second.xml"})]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<ScrollView\n    android:layout_width="match_parent"\n    android:layout_height="match_parent"\n    xmlns:android="http://schemas.android.com/apk/res/android"\n    android:background="#9C27B0"\n\n    >\n\n        <LinearLayout\n            android:orientation="vertical"\n            android:padding="16dp"\n            android:layout_width="match_parent"\n            android:layout_height="wrap_content"\n            >\n\n            <TextView\n                android:id="@+id/monsterLabel"\n                android:layout_height="wrap_content"\n                android:layout_width="match_parent"\n                android:text="Konfiguruj swojego potwora!"\n                android:textSize="20sp"\n                android:textStyle="bold"\n                android:textColor="#e1e1e1"\n                android:layout_marginBottom="8dp"\n                />\n\n            <CheckBox\n                android:id="@+id/scaryCheckBox"\n                android:layout_height="wrap_content"\n                android:layout_width="match_parent"\n                android:text="Straszny potw\xf3r "\n                android:textColor="#e1e1e1"\n                android:layout_marginTop="8dp"/>\n\n            <RadioGroup\n                android:id="@+id/colorGroup"\n                android:layout_height="wrap_content"\n                android:layout_width="match_parent"\n                android:orientation="horizontal"\n                android:layout_marginTop="8dp"\n                >\n                <RadioButton\n                    android:id="@+id/greenRadio"\n                    android:layout_height="wrap_content"\n                    android:layout_width="wrap_content"\n                    android:text="Zielony"\n                    android:textColor="#AFFF4F"\n                    />\n                <RadioButton\n                    android:id="@+id/blueRadio"\n                    android:layout_height="wrap_content"\n                    android:layout_width="wrap_content"\n                    android:text="Niebieski"\n                    android:textColor="#92CBDA"\n                    />\n                <RadioButton\n                    android:id="@+id/redRadio"\n                    android:layout_height="wrap_content"\n                    android:layout_width="match_parent"\n                    android:text="Czerwony"\n                    android:textColor="#E7C1C9"\n                    />\n            </RadioGroup>\n\n            <TextView\n                android:layout_height="wrap_content"\n                android:layout_width="match_parent"\n                android:text="Ile oczu ma tw\xf3j potw\xf3r?"\n                android:textColor="#e1e1e1"\n                android:layout_marginTop="8dp" />\n\n            <NumberPicker\n                android:id="@+id/eyesPicker"\n\n                android:layout_width="wrap_content"\n                android:layout_height="wrap_content"\n                android:layout_marginTop="4dp"/>\n\n            <Button\n                android:id="@+id/confirmButton"\n                android:layout_height="wrap_content"\n                android:layout_width="match_parent"\n                android:text="Gotowe!"\n                android:backgroundTint="@color/black"\n                android:layout_marginTop="16dp"/>\n\n        </LinearLayout>\n\n</ScrollView>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"zmiany-w-kodach-kotlina",children:"Zmiany w kodach Kotlina"}),"\n",(0,o.jsx)(e.h3,{id:"firstfragmentkt",children:(0,o.jsx)(e.code,{children:"FirstFragment.kt"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-kotlin",children:'  override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        super.onViewCreated(view, savedInstanceState)\n\n       binding.sendButton.setOnClickListener {\n           val name = binding.lastNameEditText.text.toString()\n           val action = FirstFragmentDirections\n               .actionFirstFragmentToSecondFragment(name)\n\n           findNavController().navigate(action)\n       }\n\n        // odbieranie danych z powrotu\n        findNavController().currentBackStackEntry\n            ?.savedStateHandle\n            ?.getLiveData<String>("monsterDescription")\n            ?.observe(viewLifecycleOwner) { description ->\n                binding.resultText.text = description\n            }\n\n    }\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"WYJA\u015aNIENIA"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:' findNavController().currentBackStackEntry\n            ?.savedStateHandle\n            ?.getLiveData<String>("monsterDescription")\n            ?.observe(viewLifecycleOwner) { description ->\n                binding.resultText.text = description\n            }\n\n'})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Ten kod nas\u0142uchuje (obserwuje), czy do bie\u017c\u0105cego fragmentu (",(0,o.jsx)(e.code,{children:"FirstFragment"}),")\nnie wr\xf3ci\u0142a jaka\u015b nowa warto\u015b\u0107 o kluczu ",(0,o.jsx)(e.code,{children:"monsterDescription"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Gdy ",(0,o.jsx)(e.code,{children:"SecondFragment"})," zapisze co\u015b pod tym kluczem (np. opis potwora):"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["to ",(0,o.jsx)(e.code,{children:"FirstFragment"})," automatycznie otrzyma t\u0119 warto\u015b\u0107"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"FirstFragment"})," wykona blok ",(0,o.jsx)(e.code,{children:"{ description -> ... }"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"currentBackStackEntry"})," zwraca bie\u017c\u0105cy wpis na stosie nawigacji, czyli aktualny fragment"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.admonition,{type:"tip",children:[(0,o.jsxs)(e.mdxAdmonitionTitle,{children:["Co to jest ",(0,o.jsx)(e.code,{children:"savedStateHandle"}),"?"]}),(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["To specjalny obiekt przechowuj\u0105cy dane w obr\u0119bie ",(0,o.jsx)(e.code,{children:"NavBackStackEntry"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Mo\u017cna o nim my\u015ble\u0107 jak o:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u201emini-pami\u0119ci\u201d do przekazywania danych mi\u0119dzy ekranami,"}),"\n",(0,o.jsx)(e.li,{children:"albo \u201eskrzynce pocztowej\u201d przypisanej do konkretnego fragmentu."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Zapis do ",(0,o.jsx)(e.code,{children:'savedStateHandle.set("klucz", warto\u015b\u0107)'})]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["Odczyt przez ",(0,o.jsx)(e.code,{children:'getLiveData("klucz")'})]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"getLiveData()"})," automatycznie powiadamia, gdy kto\u015b co\u015b tam w\u0142o\u017cy (czyli zaktualizuje warto\u015b\u0107)."]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,o.jsxs)(e.admonition,{type:"tip",children:[(0,o.jsxs)(e.mdxAdmonitionTitle,{children:["Co to jest ",(0,o.jsx)(e.code,{children:"viewLifecycleOwner"}),"?"]}),(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:["To obiekt, kt\xf3ry wie, kiedy widok fragmentu (czyli jego ",(0,o.jsx)(e.code,{children:"layout"})," z ``onCreateView) jest tworzony i niszczony."]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Fragment mo\u017ce:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["istnie\u0107 w pami\u0119ci (np. w ",(0,o.jsx)(e.code,{children:"FragmentManagerze"}),"),"]}),"\n",(0,o.jsxs)(e.li,{children:["ale jego widok (",(0,o.jsx)(e.code,{children:"layout"}),") mo\u017ce zosta\u0107 zniszczony i utworzony ponownie (np. po rotacji ekranu)."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"`viewLifecycleOwner oznacza:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u201eObserwuj dane tylko wtedy, gdy widok fragmentu jest aktywny (widoczny, nie zniszczony)\u201d"}),"\n",(0,o.jsxs)(e.li,{children:["Je\u015bli u\u017cytkownik np. obr\xf3ci ekran, widok si\u0119 odtworzy, i ",(0,o.jsx)(e.code,{children:"LiveData"})," znowu si\u0119 pod\u0142\u0105czy automatycznie do nowego binding."]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,o.jsx)(e.h3,{id:"secondfragmentkt",children:(0,o.jsx)(e.code,{children:"SecondFragment.kt"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-kotlin",children:' override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        super.onViewCreated(view, savedInstanceState)\n\n        binding.monsterLabel.text = "Tw\xf3j potw\xf3rz: ${args.monsterName}"\n\n        binding.eyesPicker.minValue = 1\n        binding.eyesPicker.maxValue = 10\n\n        binding.confirmButton.setOnClickListener {\n            val scary = if (binding.scaryCheckBox.isChecked) "straszny" else "uroczy"\n            val color = when(binding.colorGroup.checkedRadioButtonId){\n                binding.redRadio.id -> "czerwony"\n                binding.greenRadio.id -> "zielony"\n                binding.blueRadio.id -> "niebieski"\n                else -> ""\n\n            }\n            val eyes = binding.eyesPicker.value\n\n            val description =  "Tw\xf3j potw\xf3r ${args.monsterName} jest $scary," +\n                    " ma kolor $color i $eyes ${if (eyes == 1) "oko" else "ok"}"\n\n            findNavController()\n                .previousBackStackEntry\n                ?.savedStateHandle\n                ?.set("monsterDescription", description)\n\n            findNavController().popBackStack()\n\n        }\n    }\n'})})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(s,{...n})}):s(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>d});var a=i(6540);const o={},t=a.createContext(o);function r(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),a.createElement(t.Provider,{value:e},n.children)}}}]);